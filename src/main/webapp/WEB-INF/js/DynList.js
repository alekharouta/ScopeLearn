function reloadListing(){document.ListForm.submit()}function editFilter(E,B,A){w_filterListObj=document.getElementById("filterList");w_filterId=w_filterListObj.value;var D=w_filterListObj.options[w_filterListObj.selectedIndex].getAttribute("linkedid");var C="N";if(D>0){C="Y"}if(w_filterId==-1){alert(E);return false}OpenNote(B+"&ChildEditMode="+C+"&TracedLinkedItemID="+D+"&FilterId="+w_filterId+A,"filter",800,600)}function submitForm(){w_filterListObj=document.getElementById("filterList");w_filterId=w_filterListObj.value;var A=w_filterListObj.options[w_filterListObj.selectedIndex].linkedid;if(A>0){window.location=document.getElementById("filterList").options[document.getElementById("filterList").selectedIndex].SecURl;return false}return true}function checkin(F,K,I,G,J,M){var D="";var L=new Array();if(getCheckedItems("ListForm","checkItem",F)==0){alert(K);return false}if(F!=""&&F!=undefined){w_rows=getNumberOfRows("listView.document.ListForm","checkItem")}else{w_rows=getNumberOfRows("document.ListForm","checkItem")}if(!isUserSame(w_rows,M,F)){alert(I);return false}var A="";var H=0;if(w_rows==1){elem=getDocElem(F,"checkItem");if(F!=""&&F!=undefined){elem=listView.document.ListForm.checkItem;D=listView.document.ListForm}else{elem=document.ListForm.checkItem;D=document.ListForm}if(elem.checked){var B=w_jsonrpc.EFormHelper.getCheckInCheckOutInfoMap(D.OwnerType.value,new Number(D.OwnerID.value),D.ItemType.value,elem.value);B=B.map.toJSON();if(B.length>2){B=B.substr(1,B.length-2);keyvalues=B.split(",");if(keyvalues!=null){for(var E=0;E<keyvalues.length;E++){keyandvalue=keyvalues[E].split(":");w_checkedItemId=Trim(replaceAllStr(keyandvalue[0],'"',""));checkinCheckOutValues=keyandvalue[1].split("#");L[E]=w_checkedItemId+"#"+checkinCheckOutValues[2]}}}if(contains(L,(elem.value+"#"+J))){H++;if(F!=""&&F!=undefined){A+="&checkItem="+listView.document.ListForm.checkItem.value}else{A+="&checkItem="+document.ListForm.checkItem.value}}}}else{var C="";var B="";for(var E=0;E<w_rows;E++){if(F!=""&&F!=undefined){elem=listView.document.ListForm.checkItem[E];D=listView.document.ListForm}else{elem=document.ListForm.checkItem[E];D=document.ListForm}if(elem.checked){C+=elem.value+","}}if(C!=""){B=w_jsonrpc.EFormHelper.getCheckInCheckOutInfoMap(D.OwnerType.value,new Number(D.OwnerID.value),D.ItemType.value,C)}B=B.map.toJSON();if(B.length>2){B=B.substr(1,B.length-2);keyvalues=B.split(",");if(keyvalues!=null){for(var E=0;E<keyvalues.length;E++){keyandvalue=keyvalues[E].split(":");w_checkedItemId=Trim(replaceAllStr(keyandvalue[0],'"',""));checkinCheckOutValues=keyandvalue[1].split("#");L[E]=w_checkedItemId+"#"+checkinCheckOutValues[2]}}}for(var E=0;E<w_rows;E++){elem=getDocElem(F,"checkItem["+E+"]");if(elem.checked){if(contains(L,(elem.value+"#"+J))){H++;A+="&checkItem="+elem.value}else{alert(G);return false}}}}if(A==""){alert(G);return false}return A}function checkout(L,Q,D,R,P,K,C){if(getCheckedItems("ListForm","checkItem",L)==0){alert(Q);return false}var M="";var N="";var G=0;var I=0;var H="";var J=new Array();var A=new Array();if(L!=""&&L!=undefined){w_rows=getNumberOfRows("listView.document.ListForm","checkItem")}else{w_rows=getNumberOfRows("document.ListForm","checkItem")}if(w_rows==1){if(L!=""&&L!=undefined){elem=listView.document.ListForm.checkItem;H=listView.document.ListForm}else{elem=document.ListForm.checkItem;H=document.ListForm}if(elem.checked){var F=w_jsonrpc.EFormHelper.getCheckInCheckOutInfoMap(H.OwnerType.value,new Number(H.OwnerID.value),H.ItemType.value,elem.value);F=F.map.toJSON();if(F.length>2){F=F.substr(1,F.length-2);keyvalues=F.split(",");if(keyvalues!=null){for(var O=0;O<keyvalues.length;O++){keyandvalue=keyvalues[O].split(":");w_checkedItemId=Trim(replaceAllStr(keyandvalue[0],'"',""));checkinCheckOutValues=keyandvalue[1].split("#");J[O]=w_checkedItemId+"#"+checkinCheckOutValues[1];A[O]=w_checkedItemId+"#"+checkinCheckOutValues[2]}}}if(contains(A,(elem.value+"#"+K))){if(contains(J,(elem.value+"#"+C))){I++}else{G++;if(L!=""&&L!=undefined){M+="&checkItem="+listView.document.ListForm.checkItem.value}else{M+="&checkItem="+document.ListForm.checkItem.value}}}else{if(L!=""&&L!=undefined){N+=listView.document.ListForm.checkItem.itemid+" "}else{N+=document.ListForm.checkItem.itemid+" "}}}}else{var B="";var F="";for(var O=0;O<w_rows;O++){if(L!=""&&L!=undefined){elem=listView.document.ListForm.checkItem[O];H=listView.document.ListForm}else{elem=document.ListForm.checkItem[O];H=document.ListForm}if(elem.checked){B+=elem.value+","}}if(B!=""){F=w_jsonrpc.EFormHelper.getCheckInCheckOutInfoMap(H.OwnerType.value,new Number(H.OwnerID.value),H.ItemType.value,B)}F=F.map.toJSON();if(F.length>2){F=F.substr(1,F.length-2);keyvalues=F.split(",");if(keyvalues!=null){for(var O=0;O<keyvalues.length;O++){keyandvalue=keyvalues[O].split(":");w_checkedItemId=Trim(replaceAllStr(keyandvalue[0],'"',""));checkinCheckOutValues=keyandvalue[1].split("#");J[O]=w_checkedItemId+"#"+checkinCheckOutValues[1];A[O]=w_checkedItemId+"#"+checkinCheckOutValues[2]}}}for(var O=0;O<w_rows;O++){if(L!=""&&L!=undefined){elem=listView.document.ListForm.checkItem[O]}else{elem=document.ListForm.checkItem[O]}if(elem.checked){if(contains(A,(elem.value+"#"+K))){if(contains(J,(elem.value+"#"+C))){I++}else{G++;M+="&checkItem="+elem.value}}else{N+=elem.itemid+" "}}}}if(N!=""){alert(D+" : "+N);return false}if(M==""){alert(R);return false}if(I>0){var E=P;E=E.replace("{0}",G);E=E.replace("{1}",I);alert(E)}return M}function batchDownload(D,A,C){if(getCheckedItems("ListForm","checkItem",D)==0){alert(A);return }var B="";var E=0;if(D!=""&&D!=undefined){w_rows=getNumberOfRows("listView.document.ListForm","checkItem")}else{w_rows=getNumberOfRows("document.ListForm","checkItem")}if(w_rows==1){if(D!=""&&D!=undefined){if(listView.document.ListForm.checkItem.checked){E++;B=getParamString("ListForm","checkItem",D)}}else{if(document.ListForm.checkItem.checked){E++;B=getParamString("ListForm","checkItem",D)}}}else{B=getParamString("ListForm","checkItem",D)}window.location=C+B;return }function openBaseLineWindow(H,O,M,I,G,C,J,N){if(getCheckedItems("ListForm","checkItem",H)==0){alert(O);return }var B="";var A="";var K=0;var L=0;var D="";if(H!=""&&H!=undefined){w_rows=getNumberOfRows("listView.document.ListForm","checkItem")}else{w_rows=getNumberOfRows("document.ListForm","checkItem")}if(w_rows==1){if(H!=""&&H!=undefined){elem=listView.document.ListForm.checkItem}else{elem=document.ListForm.checkItem}if(elem.checked){if(elem.status1==null||elem.status1==undefined||elem.status1==""){elem.status1=M}if(elem.status1==M){if(elem.itemStatus!=I){K++;D=elem.value;if(D.indexOf("!")!=-1){D=D.substring(0,D.indexOf("!"))}B+="&ItemID="+D}else{L++}}else{if(H!=""&&H!=undefined){A+=listView.document.ListForm.checkItem.itemid+" "}else{A+=document.ListForm.checkItem.itemid+" "}}}}else{for(var F=0;F<w_rows;F++){if(H!=""&&H!=undefined){elem=listView.document.ListForm.checkItem[F]}else{elem=document.ListForm.checkItem[F]}if(elem.checked){if(elem.status1==null||elem.status1==undefined||elem.status1==""){elem.status1=M}if(elem.status1==M){if(elem.itemStatus!=I){K++;D=elem.value;if(D.indexOf("!")!=-1){D=D.substring(0,D.indexOf("!"))}B+="&ItemID="+D}else{L++}}else{A+=elem.itemid+" "}}}}if(A!=""){alert(G+" :"+A)}if(B==""){alert(C);return }if(L>0){var E=J;E=E.replace("{0}",K);E=E.replace("{1}",L);alert(E)}MM_openBrWindow(N+B,"Baseline","resizable=yes,left=100,top=100,height=328,width=460,scrollbars=no")}function openSplitScreenWin(A){A+="&NamedFilterID="+document.ListForm.NamedFilterID.value;window.open(A,"SplitScreen","scrollbars=yes,resizable=no,width=980,height=680,top=10,left=10,maximize=no")}function popPrint(J,O,L,M,H,K){var N="";var B=0;var D="";if(w_IsContainerType){var A=frames[J];w_SelObj=A.document.getElementById("ListForm").checkItem}else{w_SelObj=document.ListForm.checkItem}if(w_SelObj!=undefined&&w_SelObj!=null){if(w_SelObj.length==undefined){if(w_SelObj.checked){B=1;D=w_SelObj.value;if(D.indexOf("!")!=-1){D=D.substring(0,D.indexOf("!"))}N+="&checkItem="+D}}else{var E=0;var G=w_SelObj[E];while(G!=undefined&&G!=null){if(G.checked){D=G.value;if(D.indexOf("!")!=-1){D=D.substring(0,D.indexOf("!"))}N+="&checkItem="+D;B=B+1}E=E+1;G=w_SelObj[E]}}if(B==0){B=O}if(B<=L){var F=getParamString("ListForm","checkItem",J);var C=F!=""?625:570;var P=(screen.availWidth-600)/2;var I=(screen.availHeight-C)/2;window.open(M+F,"Print","resizable=yes,left="+P+",top="+I+",height="+C+",width=600,scrollbars=yes")}else{alert(H)}}else{alert(K)}}function getCheckedList(F,H,A,J){var K="";var B=0;var D="";var C="";var I;if(A){I=listView.document.ListForm}else{I=document.ListForm}if(anyCheckboxSelectedDynList(H,I,J)){if(A){w_SelObj=listView.document.ListForm.checkItem;C=listView.document.ListForm.currentPageForGrid.value}else{w_SelObj=document.ListForm.checkItem;C=document.ListForm.currentPage.value}if(w_SelObj!=undefined&&w_SelObj!=null){if(w_SelObj.length==undefined){if(w_SelObj.checked){B=1;D=w_SelObj.value;if(D.indexOf("!")!=-1){D=D.substring(0,D.indexOf("!"))}K+="&checkItem="+D}}else{var E=0;var G=w_SelObj[E];while(G!=undefined&&G!=null){if(G.checked){D=G.value;if(D.indexOf("!")!=-1){D=D.substring(0,D.indexOf("!"))}K+="&checkItem="+D;B=B+1}E=E+1;G=w_SelObj[E]}}F+="&NamedFilterID="+document.ListForm.FilterId.value+"&currentPage="+C;if(!J){if(B==0){window.open(F+"&PrintSelectedOnly=false","ImportPopup","scrollbars=no,resizable=yes,width=480,height=240,left=25,top=25")}else{window.open(F+"&PrintSelectedOnly=true"+K,"ImportPopup","scrollbars=no,resizable=yes,width=480,height=240,left=25,top=25")}}else{if(B==0){window.location=F+"&PrintSelectedOnly=false"}else{window.location=F+"&PrintSelectedOnly=true"+K}}}else{if(!J){window.open(F+"&PrintSelectedOnly=false","ImportPopup","scrollbars=no,resizable=yes,width=480,height=240,left=25,top=25")}else{window.location=F+"&PrintSelectedOnly=false"}}}}function clearAdvancedFilter(){var A=document.ListForm.FilterId;if(A!=null&&A!=undefined){A.selectedIndex=0}}function getNextSortIndex(C){var A=document.ListForm[C];var B=A.selectedIndex;A.selectedIndex=0;return B}function getNextSortOrderIndex(C){var A=document.ListForm[C];var B=A.selectedIndex;A.selectedIndex=0;return B}function loadEform(A,B){if(isIE){if(event!=null){event.returnValue=false;if(event.shiftKey){window.open(A)}else{B.location=A}}else{B.location=A}}else{B.location=A}}function clearSortFilters(){document.ListForm.PrimarySort.selectedIndex=0;document.ListForm.SecondarySort.selectedIndex=0;document.ListForm.TertiarySort.selectedIndex=0;document.ListForm.PrimarySortOrder.selectedIndex=0;document.ListForm.SecondarySortOrder.selectedIndex=0;document.ListForm.TertiarySortOrder.selectedIndex=0;return true}function reSequenceSorts(){if(document.ListForm.PrimarySort.selectedIndex==0){document.ListForm.PrimarySort.selectedIndex=getNextSortIndex("SecondarySort");document.ListForm.PrimarySortOrder.selectedIndex=getNextSortOrderIndex("SecondarySortOrder");if(document.ListForm.PrimarySort.selectedIndex==0){document.ListForm.PrimarySort.selectedIndex=getNextSortIndex("TertiarySort");document.ListForm.PrimarySortOrder.selectedIndex=getNextSortOrderIndex("TertiarySortOrder")}}if(document.ListForm.SecondarySort.selectedIndex==0){document.ListForm.SecondarySort.selectedIndex=getNextSortIndex("TertiarySort");document.ListForm.SecondarySortOrder.selectedIndex=getNextSortOrderIndex("TertiarySortOrder")}document.ListForm.NamedFilterID.value=document.ListForm.FilterId.value}function popSupport(A){window.open(A,"Support","resizable=no,toolbar=no,status=no,scrollbars=no,location=no,menubar=no,directories=no,width=640,height=385")}function openCopyrightWindow(A){var C=screen.width-50-750;var B=50;smallWindow=window.open(A,"smallWindow","toolbar=no,location=no,directories=no,status=no,menubar=no,scrollbars=no,resizable=no,width=750,height=550,left="+C+",top="+B);smallWindow.focus()}function Trim(A){while(A.indexOf(" ")!=-1&&A.indexOf(" ")==0){A=A.substring(1,A.length)}while(A.lastIndexOf(" ")!=-1&&A.lastIndexOf(" ")==A.length-1){A=A.substring(0,A.length-1)}return A}function anyCheckboxSelectedDynList(E,D,F){if(F){var C;var B=0;var A=0;for(C=0;C<D.elements.length;C++){if(D.elements[C].name=="checkItem"){A++}}if(A==1){if(D.checkItem.checked){B++}}else{if(A>1){for(C=0;C<D.checkItem.length;C++){if(D.checkItem[C].checked){B++;break}}}}if(B==0){alert(E);return false}}return true}function contains(C,A){for(var B=0;B<C.length;B++){if(C[B]==A){return true}}return false};